%% TLS 1.3 Overview & Best Practices
flowchart TB
  subgraph Stack["ðŸ”’ HTTPS Stack"]
    direction TB
    HTTP["ðŸ“„ HTTP\napplication data"]
    TLS["ðŸ” TLS 1.3\nsecure channel"]
    TCP["ðŸ“¦ TCP\nreliable delivery"]
    IP["ðŸŒ IP\nrouting"]
    HTTP --> TLS --> TCP --> IP
  end

  subgraph Guarantees["âœ“ TLS 1.3 Guarantees"]
    direction TB
    G1["ðŸ”’ Confidentiality\nAEAD encrypts all app records"]
    G2["âœ“ Integrity\nAEAD tag detects any tampering"]
    G3["ðŸŽ« Server Authenticity\ncertificate via Web PKI"]
    G4["â° Forward Secrecy\nephemeral ECDHE keys"]
    G5["ðŸ‘¥ Client Auth\nmTLS optional"]
  end

  subgraph BestPractices["âš ï¸ Safe Defaults & Pitfalls"]
    direction TB
    D1["âœ“ Prefer AEAD ciphers\nAES-GCM or ChaCha20-Poly1305"]
    D2["âœ“ Use ECDHE\nfor forward secrecy"]
    D3["âœ“ Validate certificates\nhostname + chain + expiry"]
    D4["âœ— Disable legacy\nTLS 1.0, 1.1, RSA key exchange"]
    D5["âœ— Never reuse keys\nephemeral ECDHE per session"]
    D6["ðŸ”‘ Internal auth\nmTLS or short-lived tokens"]
  end

  Stack -.-> Guarantees
  Guarantees -.-> BestPractices

  classDef stackStyle fill:#e3f2fd,stroke:#1976d2,color:#0d47a1,stroke-width:2px
  classDef guaranteeStyle fill:#f5f5f5,stroke:#616161,color:#212121,stroke-width:2px
  classDef tipStyle fill:#fff9c4,stroke:#f57f17,color:#33691e,stroke-width:2px

  class Stack stackStyle
  class Guarantees guaranteeStyle
  class BestPractices tipStyle
