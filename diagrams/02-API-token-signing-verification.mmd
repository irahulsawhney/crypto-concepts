flowchart TB
    %% Title
    Title["üß© API Token Signing and Verification using Asymmetric Cryptography"]

    %% Entities
    subgraph Issuer["Token Issuer / Authentication Server<br/>(e.g., AWS Cognito, STS)"]
        direction TB
        P["Private Key üîê Kpriv"]
        T1["Create Token Payload<br/>(client_id, permissions, expiry)"]
        T1 --> S1["Sign Token with Kpriv"]
        P -.->|Used for signing| S1
        S1 --> J["JWT / Token (Header.Payload.Signature)"]
        INote["‚Ä¢ Issuer holds PRIVATE key (Kpriv) ‚Äî never shared<br/>‚Ä¢ Used only for signing tokens<br/>‚Ä¢ Examples: AWS Cognito, STS"]
    end

    subgraph Consumer["API Client"]
        direction TB
        C1["Receives Signed Token (JWT)"]
        CNote["‚Ä¢ Token may be stored temporarily<br/>‚Ä¢ Sent in API requests as 'Authorization: Bearer ...'"]
    end

    subgraph Verifier["Backend Service / Resource Server<br/>(e.g., API Gateway)"]
        direction TB
        PU["Public Key üîì Kpub"]
        PU -.->|Used for verification| V1["Verify Signature with Kpub"]
        V1 --> V2["Check Claims<br/>(expiry, scope, audience)"]
        V2 --> A1["Access Granted ‚úÖ or Denied ‚ùå"]
        VNote["‚Ä¢ Verifier holds PUBLIC key (Kpub) ‚Äî shared widely<br/>‚Ä¢ Used only for verifying signature<br/>‚Ä¢ Examples: API Gateway, Lambda Authorizer"]
    end

    Analogy["üí° Analogy:<br/>The issuer is like a notary with a unique stamp (private key) that only they possess.<br/>Anyone can verify the stamp's authenticity using publicly available information (public key),<br/>but only the notary can create new stamps.<br/>The token is like a notarized document ‚Äî it proves who issued it and that it hasn't been tampered with."]

    %% Data Flow
    J --> C1
    C1 ~~~ separator1[ ]
    separator1 ~~~ Verifier
    C1 -->|Sends Token in Request| V1

    %% Styling
    style Issuer stroke:#7a42f4,stroke-width:1px
    style Consumer stroke:#0099cc,stroke-width:1px
    style Verifier stroke:#00b386,stroke-width:1px
    style Title fill:none,stroke:none
    style separator1 fill:none,stroke:none
