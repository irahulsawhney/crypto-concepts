%% Widget + CAS + Webhook â€” Flowchart
%% Widget + CAS + Webhook â€” Flowchart (matches image)
flowchart TD
  Browser["Browser"]
  Supplier["Supplier Service"]
  Address["Address Service\n(AEAD + KMS)"]
  Federate["Federate (IdP)"]

  Browser -- "TLS 1.3 POST\nNew Address" --> Supplier
  Supplier -- "addressID" --> Browser
  Supplier -- "addressID" --> Address
  Address -- "addressID" --> Supplier
  Supplier -- "Store address_ref only" --> Supplier
  Browser -- "TLS GET view(address_id)\nwith short-lived token" --> Supplier
  Supplier -- "addressID" --> Browser
  Browser -- "Render plaintext address" --> Browser
  Supplier -- "client assertion" --> Federate
  Federate -- "access token" --> Supplier
