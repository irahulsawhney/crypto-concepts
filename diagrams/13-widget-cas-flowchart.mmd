%% Widget + CAS + Webhook â€” Sequence Diagram
sequenceDiagram
  participant Browser
  participant Supplier
  participant Address as "Address Service (AEAD + KMS)"
  participant Federate as "Federate (IdP)"

  Browser->>Supplier: TLS 1.3 POST New Address
  Supplier-->>Browser: addressID
  Supplier->>Address: addressID
  Address-->>Supplier: addressID
  Supplier->>Supplier: Store address_ref only
  Browser->>Supplier: TLS GET view(address_id) with short-lived token
  Supplier-->>Browser: addressID
  Browser->>Browser: Render plaintext address
  Supplier->>Federate: client assertion
  Federate-->>Supplier: access token
