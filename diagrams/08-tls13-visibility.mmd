%% TLS 1.3 - What's Visible vs Hidden
flowchart LR
  V["Visible to network observers:\n• IPs, ports\n• ClientHello fields - e.g. SNI host before ECH\n• Record sizes and timing"]
  H["Hidden - encrypted within TLS records:\n• HTTP methods, URLs - path and query\n• HTTP headers and bodies\n• Post-ServerHello handshake messages"]
  V -->|cannot read| H

  note1["Note: Encrypted Client Hello ECH can hide SNI when deployed"]

  classDef vis fill:#fff8e1,stroke:#ffcc80,color:#e65100,stroke-width:1px
  classDef hid fill:#e8f5e9,stroke:#7cb342,color:#1b5e20,stroke-width:1px
  classDef info fill:#f7f7f7,stroke:#bbb,color:#333,stroke-width:1px

  class V vis
  class H hid
  class note1 info
